<div class="dashboard-admin">
    <!-- Header -->
    <div class="header">
        <h1>üìä Painel Administrativo Reutiliza</h1>

        <div class="filtros">
            <button (click)="alterarPeriodo(7)" [class.ativo]="periodo === 7">
                √öltimos 7 dias
            </button>
            <button (click)="alterarPeriodo(30)" [class.ativo]="periodo === 30">
                √öltimos 30 dias
            </button>
            <button (click)="alterarPeriodo(90)" [class.ativo]="periodo === 90">
                √öltimos 90 dias
            </button>
            <button (click)="carregarMetricas()" class="refresh">
                üîÑ Atualizar
            </button>
        </div>
    </div>

    <!-- Loading -->
    <div *ngIf="carregando" class="loading">
        <div class="spinner"></div>
        <p>Carregando m√©tricas...</p>
    </div>

    <!-- Erro -->
    <div *ngIf="erro && !carregando" class="erro">
        <p>{{ erro }}</p>
        <button (click)="carregarMetricas()">Tentar novamente</button>
    </div>

    <!-- Dashboard -->
    <div *ngIf="metricas && !carregando" class="dashboard-content">

        <!-- Alertas Urgentes -->
        <div class="alertas-section" *ngIf="metricas.alertas.denunciasPendentes > 0 || metricas.alertas.materiaisPendentes > 0">
            <h2>‚ö†Ô∏è Alertas</h2>
            <div class="alertas-grid">
                <div class="alerta urgente" *ngIf="metricas.alertas.denunciasPendentes > 0"
                     (click)="navegarPara('denuncias')">
                    <div class="alerta-icon">üö®</div>
                    <div class="alerta-info">
                        <h3>{{ metricas.alertas.denunciasPendentes }}</h3>
                        <p>Den√∫ncias Pendentes</p>
                    </div>
                </div>

                <div class="alerta aviso" *ngIf="metricas.alertas.materiaisPendentes > 0"
                     (click)="navegarPara('validacao')">
                    <div class="alerta-icon">‚è≥</div>
                    <div class="alerta-info">
                        <h3>{{ metricas.alertas.materiaisPendentes }}</h3>
                        <p>Materiais Pendentes</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Cards de M√©tricas -->
        <div class="metricas-grid">

            <!-- Card Usu√°rios -->
            <div class="metric-card usuarios" (click)="navegarPara('usuarios')">
                <div class="card-header">
                    <h3>üë• Usu√°rios</h3>
                    <span class="badge">{{ metricas.usuarios.total }}</span>
                </div>
                <div class="card-body">
                    <div class="metric-row">
                        <span>Ativos (√∫ltimos {{ periodo }} dias)</span>
                        <strong>{{ metricas.usuarios.ativos }}</strong>
                    </div>
                    <div class="metric-row">
                        <span>Novos</span>
                        <strong>{{ metricas.usuarios.novos }}</strong>
                    </div>
                    <div class="metric-row">
                        <span>Taxa de Ativa√ß√£o</span>
                        <strong>{{ metricas.usuarios.taxaAtivacao }}%</strong>
                    </div>
                </div>
                <div class="card-footer" [ngClass]="getCorCrescimento(metricas.usuarios.crescimento)">
                    <span>{{ getIconeCrescimento(metricas.usuarios.crescimento) }}</span>
                    <span>{{ metricas.usuarios.crescimento }}% vs per√≠odo anterior</span>
                </div>
            </div>

            <!-- Card Materiais -->
            <div class="metric-card materiais" (click)="navegarPara('materiais')">
                <div class="card-header">
                    <h3>‚ôªÔ∏è Materiais</h3>
                    <span class="badge">{{ metricas.materiais.total }}</span>
                </div>
                <div class="card-body">
                    <div class="metric-row">
                        <span>Validados</span>
                        <strong>{{ metricas.materiais.validados }}</strong>
                    </div>
                    <div class="metric-row">
                        <span>Pendentes</span>
                        <strong class="pendente">{{ metricas.materiais.pendentes }}</strong>
                    </div>
                    <div class="metric-row">
                        <span>Taxa de Valida√ß√£o</span>
                        <strong>{{ metricas.materiais.taxaValidacao }}%</strong>
                    </div>
                </div>
                <div class="card-footer" [ngClass]="getCorCrescimento(metricas.materiais.crescimento)">
                    <span>{{ getIconeCrescimento(metricas.materiais.crescimento) }}</span>
                    <span>{{ metricas.materiais.crescimento }}% vs per√≠odo anterior</span>
                </div>
            </div>

            <!-- Card Pontos de Coleta -->
            <div class="metric-card pontos" (click)="navegarPara('pontos')">
                <div class="card-header">
                    <h3>üìç Pontos de Coleta</h3>
                    <span class="badge">{{ metricas.pontos.total }}</span>
                </div>
                <div class="card-body">
                    <div class="metric-row">
                        <span>Ativos</span>
                        <strong class="success">{{ metricas.pontos.ativos }}</strong>
                    </div>
                    <div class="metric-row">
                        <span>Inativos</span>
                        <strong class="danger">{{ metricas.pontos.inativos }}</strong>
                    </div>
                    <div class="metric-row">
                        <span>M√©dia usu√°rios/ponto</span>
                        <strong>{{ metricas.pontos.mediaUsuariosPorPonto }}</strong>
                    </div>
                </div>
            </div>

            <!-- Card Recompensas -->
            <div class="metric-card recompensas" (click)="navegarPara('recompensas')">
                <div class="card-header">
                    <h3>üéÅ Recompensas</h3>
                    <span class="badge">{{ metricas.recompensas.totalResgates }}</span>
                </div>
                <div class="card-body">
                    <div class="metric-row">
                        <span>Resgates ({{ periodo }} dias)</span>
                        <strong>{{ metricas.recompensas.totalResgates }}</strong>
                    </div>
                    <div class="metric-row">
                        <span>Pontos em Circula√ß√£o</span>
                        <strong>{{ metricas.recompensas.pontosEmCirculacao }}</strong>
                    </div>
                </div>
            </div>

        </div>

        <!-- A√ß√µes R√°pidas -->
        <div class="acoes-rapidas">
            <h2>‚ö° A√ß√µes R√°pidas</h2>
            <div class="acoes-grid">
                <button class="acao-btn" (click)="navegarPara('denuncias')">
                    <span class="acao-icon">üö®</span>
                    <span>Gerenciar Den√∫ncias</span>
                </button>

                <button class="acao-btn" (click)="navegarPara('validacao')">
                    <span class="acao-icon">‚úÖ</span>
                    <span>Validar Materiais</span>
                </button>

                <button class="acao-btn" (click)="navegarPara('pontos')">
                    <span class="acao-icon">üìç</span>
                    <span>Gerenciar Pontos</span>
                </button>

                <button class="acao-btn" (click)="navegarPara('usuarios')">
                    <span class="acao-icon">üë•</span>
                    <span>Gerenciar Usu√°rios</span>
                </button>

                <button class="acao-btn" (click)="navegarPara('recompensas')">
                    <span class="acao-icon">üéÅ</span>
                    <span>Gerenciar Recompensas</span>
                </button>

                <button class="acao-btn" (click)="navegarPara('metricas')">
                    <span class="acao-icon">üìä</span>
                    <span>Ver M√©tricas Completas</span>
                </button>
            </div>
        </div>

    </div>
</div>